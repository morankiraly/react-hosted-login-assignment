{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"callback\"],\n  _excluded2 = [\"callback\"],\n  _excluded3 = [\"callback\"];\nimport { call, put, select, takeLeading } from 'redux-saga/effects';\nimport { api, AuthStrategyEnum } from '@frontegg/rest-api';\nimport { actions } from '../reducer';\nimport { ResetPhoneNumberStep } from './interfaces';\nimport { LoginStep } from '../LoginState/interfaces';\nfunction* resetPhoneNumber(_ref) {\n  let {\n      payload: {\n        callback\n      }\n    } = _ref,\n    body = _objectWithoutPropertiesLoose(_ref.payload, _excluded);\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n  try {\n    const res = yield call(api.auth.resetPhoneNumber, body);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: undefined,\n      resetPhoneNumberToken: res.resetPhoneNumberToken,\n      step: ResetPhoneNumberStep.VerifyResetPhoneNumber\n    }));\n    yield put(actions.setLoginState({\n      email: body.email\n    }));\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\nfunction* verifyResetPhoneNumber(_ref2) {\n  let {\n      payload: {\n        callback\n      }\n    } = _ref2,\n    body = _objectWithoutPropertiesLoose(_ref2.payload, _excluded2);\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n  try {\n    const res = yield call(api.auth.verifyResetPhoneNumber, body);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: undefined,\n      changePhoneNumberToken: res.changePhoneNumberToken,\n      step: ResetPhoneNumberStep.ChangePhoneNumber\n    }));\n    callback == null ? void 0 : callback(true);\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\nexport function* changePhoneNumber(_ref3) {\n  let {\n      payload: {\n        callback\n      }\n    } = _ref3,\n    body = _objectWithoutPropertiesLoose(_ref3.payload, _excluded3);\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n  try {\n    const {\n      onRedirectTo,\n      routes\n    } = yield select(_ref4 => {\n      let {\n        auth: {\n          onRedirectTo,\n          routes\n        }\n      } = _ref4;\n      return {\n        onRedirectTo,\n        routes\n      };\n    });\n    yield call(api.auth.changePhoneNumber, {\n      phoneNumber: body.phoneNumber,\n      changePhoneNumberToken: body.changePhoneNumberToken\n    });\n    yield put(actions.setLoginState({\n      step: LoginStep.loginWithSmsOtc\n    }));\n    yield put(actions.passwordlessPreLogin({\n      type: AuthStrategyEnum.SmsCode,\n      email: body.email,\n      recaptchaToken: body.recaptchaToken\n    }));\n    onRedirectTo(routes.loginUrl);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false\n    }));\n    callback == null ? void 0 : callback(true);\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\nexport function* resetPhoneNumberSagas() {\n  yield takeLeading(actions.resetPhoneNumber, resetPhoneNumber);\n  yield takeLeading(actions.verifyResetPhoneNumber, verifyResetPhoneNumber);\n  yield takeLeading(actions.changePhoneNumber, changePhoneNumber);\n}","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_excluded","_excluded2","_excluded3","call","put","select","takeLeading","api","AuthStrategyEnum","actions","ResetPhoneNumberStep","LoginStep","resetPhoneNumber","_ref","payload","callback","body","setResetPhoneNumberState","loading","res","auth","error","undefined","resetPhoneNumberToken","step","VerifyResetPhoneNumber","setLoginState","email","e","message","verifyResetPhoneNumber","_ref2","changePhoneNumberToken","ChangePhoneNumber","changePhoneNumber","_ref3","onRedirectTo","routes","phoneNumber","loginWithSmsOtc","passwordlessPreLogin","type","SmsCode","recaptchaToken","loginUrl","resetPhoneNumberSagas"],"sources":["/Users/sagiittah/Downloads/my-app/node_modules/@frontegg/redux-store/auth/ResetPhoneNumberState/saga.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"callback\"],\n      _excluded2 = [\"callback\"],\n      _excluded3 = [\"callback\"];\nimport { call, put, select, takeLeading } from 'redux-saga/effects';\nimport { api, AuthStrategyEnum } from '@frontegg/rest-api';\nimport { actions } from '../reducer';\nimport { ResetPhoneNumberStep } from './interfaces';\nimport { LoginStep } from '../LoginState/interfaces';\n\nfunction* resetPhoneNumber(_ref) {\n  let {\n    payload: {\n      callback\n    }\n  } = _ref,\n      body = _objectWithoutPropertiesLoose(_ref.payload, _excluded);\n\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n\n  try {\n    const res = yield call(api.auth.resetPhoneNumber, body);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: undefined,\n      resetPhoneNumberToken: res.resetPhoneNumberToken,\n      step: ResetPhoneNumberStep.VerifyResetPhoneNumber\n    }));\n    yield put(actions.setLoginState({\n      email: body.email\n    }));\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\n\nfunction* verifyResetPhoneNumber(_ref2) {\n  let {\n    payload: {\n      callback\n    }\n  } = _ref2,\n      body = _objectWithoutPropertiesLoose(_ref2.payload, _excluded2);\n\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n\n  try {\n    const res = yield call(api.auth.verifyResetPhoneNumber, body);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: undefined,\n      changePhoneNumberToken: res.changePhoneNumberToken,\n      step: ResetPhoneNumberStep.ChangePhoneNumber\n    }));\n    callback == null ? void 0 : callback(true);\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\n\nexport function* changePhoneNumber(_ref3) {\n  let {\n    payload: {\n      callback\n    }\n  } = _ref3,\n      body = _objectWithoutPropertiesLoose(_ref3.payload, _excluded3);\n\n  yield put(actions.setResetPhoneNumberState({\n    loading: true\n  }));\n\n  try {\n    const {\n      onRedirectTo,\n      routes\n    } = yield select(({\n      auth: {\n        onRedirectTo,\n        routes\n      }\n    }) => ({\n      onRedirectTo,\n      routes\n    }));\n    yield call(api.auth.changePhoneNumber, {\n      phoneNumber: body.phoneNumber,\n      changePhoneNumberToken: body.changePhoneNumberToken\n    });\n    yield put(actions.setLoginState({\n      step: LoginStep.loginWithSmsOtc\n    }));\n    yield put(actions.passwordlessPreLogin({\n      type: AuthStrategyEnum.SmsCode,\n      email: body.email,\n      recaptchaToken: body.recaptchaToken\n    }));\n    onRedirectTo(routes.loginUrl);\n    yield put(actions.setResetPhoneNumberState({\n      loading: false\n    }));\n    callback == null ? void 0 : callback(true);\n  } catch (e) {\n    yield put(actions.setResetPhoneNumberState({\n      loading: false,\n      error: e.message\n    }));\n    callback == null ? void 0 : callback(null, e);\n  }\n}\nexport function* resetPhoneNumberSagas() {\n  yield takeLeading(actions.resetPhoneNumber, resetPhoneNumber);\n  yield takeLeading(actions.verifyResetPhoneNumber, verifyResetPhoneNumber);\n  yield takeLeading(actions.changePhoneNumber, changePhoneNumber);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}